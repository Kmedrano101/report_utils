<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width='297mm' height='210mm' viewBox="0 0 1123 794">
  <!-- A4 Landscape: 297mm x 210mm -->
  <!-- Template: Sound Levels - Noise Pollution Analysis Report -->

  <!-- Styles -->
  <defs>
    <style type="text/css">
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap');

      .metric-title { font-family: 'Inter', sans-serif; font-size: 10px; font-weight: 600; fill: {{metric_title_color}}; text-transform: uppercase; letter-spacing: 0.05em; }
      .metric-value { font-family: 'Inter', sans-serif; font-size: 22px; font-weight: 700; fill: {{metric_value_color}}; }
      .metric-unit { font-family: 'Inter', sans-serif; font-size: 11px; fill: {{metric_title_color}}; }
      .section-header { font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 600; fill: {{section_header_color}}; }
      .table-header { font-family: 'Inter', sans-serif; font-size: 10px; font-weight: 600; fill: {{table_header_color}}; text-transform: uppercase; }
      .table-text { font-family: 'Inter', sans-serif; font-size: 11px; fill: {{table_text_color}}; }
      .table-small { font-family: 'Inter', sans-serif; font-size: 9px; fill: {{table_header_color}}; }

      .card { fill: #ffffff; stroke: {{card_border_color}}; stroke-width: 1; }
      .card-temperature { fill: {{accent_secondary}}; stroke: {{card_border_color}}; stroke-width: 1.5; }
      .card-humidity { fill: {{accent_secondary}}; stroke: {{card_border_color}}; stroke-width: 1.5; }
      .card-sound { fill: {{accent_secondary}}; stroke: {{card_border_color}}; stroke-width: 1.5; }
      .card-power { fill: {{accent_secondary}}; stroke: {{card_border_color}}; stroke-width: 1.5; }
      .card-noise { fill: {{accent_secondary}}; stroke: {{card_border_color}}; stroke-width: 1.5; }
      .card-details { fill: {{accent_secondary}}; stroke: {{card_border_color}}; stroke-width: 1.5; }
      .divider { stroke: {{card_border_color}}; stroke-width: 0.8; }
    </style>
  </defs>

  <!-- Background -->
  <rect width="1123" height="794" fill="#FFFFFF"/>

  <!-- ========================================= -->
  <!-- HEADER SECTION (Customizable) -->
  <!-- ========================================= -->
  <g id="header">
    <rect width="1123" height="110" fill="{{header_bg}}"/>
    <image href="{{logo_url}}" x="45" y="15" width="105" height="105" preserveAspectRatio="xMidYMid meet"/>
    <text x="190" y="45" fill="{{header_text_color}}" font-size="24" font-family="Inter, Arial, sans-serif" font-weight="700">
      {{header_title}}
    </text>
    <text x="190" y="80" fill="{{header_subtitle_color}}" font-size="16" font-family="Inter, Arial, sans-serif" font-weight="400">
      {{header_subtitle}}
    </text>
  </g>

  <!-- ========================================= -->
  <!-- CONTENT AREA STARTS HERE (2-Column Layout) -->
  <!-- ========================================= -->

  <!-- LEFT COLUMN -->
  <g id="left-column">
    <!-- Report Info Bar -->
    <g id="report-info">
      <rect x="30" y="130" width="520" height="48" class="card-elevated" rx="6" ry="6"/>

      <g transform="translate(50, 130)">
        <text y="18" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#6B7280" letter-spacing="0.5">NOMBRE DEL EDIFICIO</text>
        <text y="36" font-family="Inter, sans-serif" font-size="13" font-weight="600" fill="#111827">{{building_name}}</text>
      </g>

      <g transform="translate(220, 130)">
        <text y="18" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#6B7280" letter-spacing="0.5">PERIODO DEL INFORME</text>
        <text y="36" font-family="Inter, sans-serif" font-size="13" font-weight="600" fill="#111827">{{date_range}}</text>
      </g>

      <g transform="translate(380, 130)">
        <text y="18" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#6B7280" letter-spacing="0.5">SENSORES</text>
        <text y="38" font-family="Inter, sans-serif" font-size="16" font-weight="700" fill="#111827">{{total_sensors}} / <tspan fill="{{accent_primary}}">{{active_sensors}}</tspan></text>
      </g>
    </g>

    <!-- Traffic Light Indicator: Acoustic Comfort -->
    <g id="acoustic-comfort-indicator">
      <rect x="30" y="190" width="520" height="360" class="card" rx="6"/>

      <!-- Title -->
      <text x="50" y="215" class="section-header" font-size="13">üîä Acoustic Comfort</text>

      <!-- Sound Wave Visualization -->
      <g id="sound-waves" transform="translate(50, 235)">
        <!-- Green zone waves -->
        <path d="M 0,30 Q 25,10 50,30 T 100,30 T 150,30 T 200,30"
              stroke="{{acoustic_wave_color}}"
              stroke-width="7"
              fill="none"
              stroke-linecap="round"
              opacity="0.8"/>

        <!-- Amplitude indicator -->
        <path d="M 220,30 Q 235,{{acoustic_wave_amplitude}} 250,30"
              stroke="{{acoustic_wave_color}}"
              stroke-width="10"
              fill="none"
              stroke-linecap="round"/>

        <!-- dB Scale markers -->
        <line x1="280" y1="10" x2="280" y2="50" stroke="#CBD5E1" stroke-width="1.5"/>
        <text x="290" y="15" font-family="Inter, sans-serif" font-size="9" fill="#6B7280">60 dB (Critical)</text>
        <text x="290" y="32" font-family="Inter, sans-serif" font-size="9" fill="#10B981">35-45 dB (Comfort)</text>
        <text x="290" y="50" font-family="Inter, sans-serif" font-size="9" fill="#94A3B8">Current: {{avg_sound}} dB</text>
      </g>

      <!-- Status Description -->
      <g id="acoustic-status">
        <circle cx="60" cy="310" r="10" fill="{{acoustic_status_color}}"/>
        <text x="78" y="315" font-family="Inter, sans-serif" font-size="12" font-weight="600" fill="{{metric_value_color}}">{{acoustic_status_text}}</text>
        <text x="50" y="335" font-family="Inter, sans-serif" font-size="10" fill="{{table_header_color}}">{{acoustic_comfort_percentage}}% time in comfort zone (35-45 dB)</text>
      </g>

      <!-- Noise Level Breakdown -->
      <g id="noise-breakdown" transform="translate(50, 350)">
        <rect x="0" y="0" width="460" height="180" fill="{{accent_secondary}}" rx="4" opacity="0.05"/>

        <text x="15" y="25" font-family="Inter, sans-serif" font-size="11" font-weight="600" fill="{{metric_value_color}}">Noise Level Distribution</text>

        <g transform="translate(15, 50)">
          <circle cx="5" cy="-3" r="4" fill="#10B981"/>
          <text x="15" y="0" font-family="Inter, sans-serif" font-size="9" fill="{{table_text_color}}">Comfort Zone (35-45 dB)</text>
          <text x="220" y="0" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="{{metric_value_color}}">{{acoustic_comfort_percentage}}%</text>
        </g>

        <g transform="translate(15, 70)">
          <circle cx="5" cy="-3" r="4" fill="#F59E0B"/>
          <text x="15" y="0" font-family="Inter, sans-serif" font-size="9" fill="{{table_text_color}}">Moderate (46-59 dB)</text>
          <text x="220" y="0" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="{{metric_value_color}}">{{acoustic_moderate_percentage}}%</text>
        </g>

        <g transform="translate(15, 90)">
          <circle cx="5" cy="-3" r="4" fill="#EF4444"/>
          <text x="15" y="0" font-family="Inter, sans-serif" font-size="9" fill="{{table_text_color}}">Critical (‚â•60 dB)</text>
          <text x="220" y="0" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="{{metric_value_color}}">{{acoustic_critical_percentage}}%</text>
        </g>

        <line x1="15" y1="110" x2="445" y2="110" stroke="{{card_border_color}}" stroke-width="1"/>

        <g transform="translate(15, 130)">
          <text x="0" y="0" font-family="Inter, sans-serif" font-size="9" fill="{{table_header_color}}">Peak Sound Level</text>
          <text x="0" y="18" font-family="Inter, sans-serif" font-size="16" font-weight="700" fill="#EF4444">{{peak_sound}} dB</text>
        </g>

        <g transform="translate(150, 130)">
          <text x="0" y="0" font-family="Inter, sans-serif" font-size="9" fill="{{table_header_color}}">Average Level</text>
          <text x="0" y="18" font-family="Inter, sans-serif" font-size="16" font-weight="700" fill="#F59E0B">{{avg_sound}} dB</text>
        </g>
      </g>
    </g>
  </g>

  <!-- RIGHT COLUMN -->
  <g id="right-column">
    <!-- Power Consumption Analysis Chart -->
    <g id="chart-section">
      <text x="570" y="145" class="section-header">Noise Pollution Analysis - Noisiest Locations</text>

      <rect x="570" y="155" width="523" height="250" class="card" rx="6"/>

      <!-- Two Column Layout: Left 40% (Electric Image) | Right 60% (Chart + Legend) -->

      <!-- LEFT COLUMN: Electric Image (40% = ~209px) -->
      <g id="electric-section" transform="translate(580, 165)">
        <!-- Electric Image -->
        <image href="{{sound_url}}" x="20" y="5" width="80" height="180" preserveAspectRatio="xMidYMid meet"/>

        <!-- Consumption values on the right side -->
        <!-- Max consumption (top - HIGH level = red) -->
        <g id="max-consumption-display" transform="translate(110, 25)">
          <text x="0" y="0" fill="#ef4444" font-family="Inter, sans-serif" font-size="8" font-weight="700">MAX</text>
          <text x="0" y="16" fill="#ef4444" font-family="Inter, sans-serif" font-size="14" font-weight="700">{{overall_max_consumption}} {{max_consumption_unit}}</text>
        </g>

        <!-- Average consumption (middle - NORMAL level = yellow/amber) -->
        <g id="avg-consumption-display" transform="translate(110, 85)">
          <text x="0" y="0" fill="#f59e0b" font-family="Inter, sans-serif" font-size="8" font-weight="700">AVG</text>
          <text x="0" y="16" fill="#f59e0b" font-family="Inter, sans-serif" font-size="12" font-weight="700">{{overall_avg_consumption}} {{avg_consumption_unit}}</text>
        </g>

        <!-- Min consumption (bottom - LOW level = green) -->
        <g id="min-consumption-display" transform="translate(110, 145)">
          <text x="0" y="0" fill="#10b981" font-family="Inter, sans-serif" font-size="8" font-weight="700">MIN</text>
          <text x="0" y="16" fill="#10b981" font-family="Inter, sans-serif" font-size="14" font-weight="700">{{overall_min_consumption}} {{min_consumption_unit}}</text>
        </g>
      </g>

      <!-- RIGHT COLUMN: Chart + Legend (60% = ~314px) -->
      <g id="chart-column" transform="translate(779, 155)">
        <!-- Chart Legend -->
        <g id="chart-legend">
          <text x="10" y="20" class="table-small">
            <tspan fill="#3b82f6">‚ñ†</tspan> Sensor C1
          </text>
          <text x="100" y="20" class="table-small">
            <tspan fill="#10b981">‚ñ†</tspan> Sensor C2
          </text>
          <text x="200" y="20" class="table-small">
            <tspan fill="#9ca3af">‚îÅ</tspan> Avg
          </text>
        </g>

        <!-- Chart Placeholder -->
        <foreignObject x="0" y="30" width="304" height="210">
          <div xmlns="http://www.w3.org/1999/xhtml" id="chart-container" style="width:100%; height:100%;">
            <canvas id="noise-comparison-chart"></canvas>
          </div>
        </foreignObject>
      </g>
    </g>

    <!-- Consumption Details Section -->
    <g id="consumption-details">
      <text x="570" y="435" class="section-header">Consumption Details & Peak Loads</text>

      <!-- Total Consumption Details Card -->
      <rect x="570" y="445" width="523" height="110" class="card-details" rx="6"/>
      <text x="585" y="465" fill="#94a3b8" font-family="Inter, sans-serif" font-size="10" font-weight="600" text-transform="uppercase">
        Total Consumption Summary
      </text>

      <!-- 3 Column Layout: Amperes | kWh | Estimated Cost -->
      <g id="consumption-amperes">
        <text x="610" y="495" fill="#64748b" font-family="Inter, sans-serif" font-size="9" font-weight="600">Total Amperes</text>
        <text x="610" y="517" fill="#ffffff" font-family="Inter, sans-serif" font-size="16" font-weight="700">{{total_amperes}}</text>
        <text x="610" y="533" fill="#94a3b8" font-family="Inter, sans-serif" font-size="10">A</text>
      </g>

      <g id="consumption-kwh">
        <text x="790" y="495" fill="#64748b" font-family="Inter, sans-serif" font-size="9" font-weight="600">Total Energy</text>
        <text x="790" y="517" fill="#ffffff" font-family="Inter, sans-serif" font-size="16" font-weight="700">{{total_kwh}}</text>
        <text x="790" y="533" fill="#94a3b8" font-family="Inter, sans-serif" font-size="10">kWh</text>
      </g>

      <g id="consumption-cost">
        <text x="970" y="495" fill="#64748b" font-family="Inter, sans-serif" font-size="9" font-weight="600">Estimated Cost (Spain)</text>
        <text x="970" y="517" fill="#10b981" font-family="Inter, sans-serif" font-size="16" font-weight="700">‚Ç¨{{total_cost}}</text>
        <text x="970" y="533" fill="#94a3b8" font-family="Inter, sans-serif" font-size="10">EUR</text>
      </g>
    </g>

    <!-- Peak Load Times Section -->
    <g id="peak-loads">
      <rect x="570" y="565" width="523" height="130" class="card-noise" rx="6"/>
      <text x="585" y="585" fill="#94a3b8" font-family="Inter, sans-serif" font-size="10" font-weight="600" text-transform="uppercase">
        <tspan fill="#ef4444">‚ö°</tspan> Peak Load Events
      </text>

      <!-- Peak Row 1 -->
      <text x="585" y="610" fill="#ffffff" font-family="Inter, sans-serif" font-size="11" font-weight="600">#1 {{peak_1_sensor}} - {{peak_1_channel}}</text>
      <text x="780" y="610" fill="#ffffff" font-family="Inter, sans-serif" font-size="14" font-weight="700">{{peak_1_value}}<tspan fill="#94a3b8" font-size="10">A</tspan></text>
      <text x="880" y="610" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9">{{peak_1_time}}</text>
      <text x="1040" y="610" fill="#ef4444" font-family="Inter, sans-serif" font-size="10">{{peak_1_power}} kW</text>

      <!-- Peak Row 2 -->
      <text x="585" y="640" fill="#ffffff" font-family="Inter, sans-serif" font-size="11" font-weight="600">#2 {{peak_2_sensor}} - {{peak_2_channel}}</text>
      <text x="780" y="640" fill="#ffffff" font-family="Inter, sans-serif" font-size="14" font-weight="700">{{peak_2_value}}<tspan fill="#94a3b8" font-size="10">A</tspan></text>
      <text x="880" y="640" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9">{{peak_2_time}}</text>
      <text x="1040" y="640" fill="#ef4444" font-family="Inter, sans-serif" font-size="10">{{peak_2_power}} kW</text>

      <!-- Peak Row 3 -->
      <text x="585" y="670" fill="#ffffff" font-family="Inter, sans-serif" font-size="11" font-weight="600">#3 {{peak_3_sensor}} - {{peak_3_channel}}</text>
      <text x="780" y="670" fill="#ffffff" font-family="Inter, sans-serif" font-size="14" font-weight="700">{{peak_3_value}}<tspan fill="#94a3b8" font-size="10">A</tspan></text>
      <text x="880" y="670" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9">{{peak_3_time}}</text>
      <text x="1040" y="670" fill="#ef4444" font-family="Inter, sans-serif" font-size="10">{{peak_3_power}} kW</text>
    </g>
  </g>

  <!-- ========================================= -->
  <!-- FOOTER SECTION (Customizable) -->
  <!-- ========================================= -->
  <g id="footer">
    <line x1="30" y1="725" x2="1093" y2="725" stroke="{{footer_bg}}" stroke-width="2"/>
    <rect y="733" width="1123" height="61" fill="{{footer_bg}}"/>
    <text x="40" y="767" fill="{{footer_text_color}}" font-size="12" font-family="Inter, Arial, sans-serif">
      {{footer_text}}
    </text>
    <text x="1083" y="767" fill="{{footer_date_color}}" font-size="12" font-family="Inter, Arial, sans-serif" text-anchor="end">
      {{generation_date}}
    </text>
  </g>
</svg>
