<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width='210mm' height='297mm' viewBox="0 0 794 1123">
  <!-- A4 Portrait: 210mm x 297mm -->
  <!-- Template: Sound Levels - Noise Pollution Analysis Report (Vertical) - PROFESSIONAL VERSION -->

  <!-- ========================================= -->
  <!-- DEFINITIONS (Styles, Gradients, Filters) -->
  <!-- ========================================= -->
  <defs>
    <style type="text/css">
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');

      .metric-title { font-family: 'Inter', sans-serif; font-size: 10px; font-weight: 600; fill: {{metric_title_color}}; text-transform: uppercase; letter-spacing: 0.05em; }
      .metric-value { font-family: 'Inter', sans-serif; font-size: 22px; font-weight: 700; fill: {{metric_value_color}}; }
      .metric-unit { font-family: 'Inter', sans-serif; font-size: 11px; fill: {{metric_title_color}}; }
      .section-header { font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 600; fill: {{section_header_color}}; }
      .table-header { font-family: 'Inter', sans-serif; font-size: 10px; font-weight: 600; fill: {{table_header_color}}; text-transform: uppercase; }
      .table-text { font-family: 'Inter', sans-serif; font-size: 11px; fill: {{table_text_color}}; }
      .table-small { font-family: 'Inter', sans-serif; font-size: 9px; fill: {{table_header_color}}; }

      .card { fill: #ffffff; stroke: {{card_border_color}}; stroke-width: 1; }
      .card-elevated { fill: #ffffff; stroke: {{card_border_color}}; stroke-width: 1; filter: url(#dropShadow); }
      .card-temperature { fill: {{accent_secondary}}; stroke: {{card_border_color}}; stroke-width: 1.5; }
      .card-noise { fill: {{accent_secondary}}; stroke: {{card_border_color}}; stroke-width: 1.5; }
      .card-details { fill: {{accent_secondary}}; stroke: {{card_border_color}}; stroke-width: 1.5; }
      .divider { stroke: {{card_border_color}}; stroke-width: 0.8; }
    </style>

    <!-- Drop shadow for card elevation -->
    <filter id="dropShadow" x="-10%" y="-10%" width="120%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000000" flood-opacity="0.12"/>
    </filter>

    <!-- Glass overlay effect -->
    <linearGradient id="glassOverlay" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#FFFFFF" stop-opacity="0.3"/>
      <stop offset="45%" stop-color="#FFFFFF" stop-opacity="0.08"/>
      <stop offset="55%" stop-color="#000000" stop-opacity="0.03"/>
      <stop offset="100%" stop-color="#000000" stop-opacity="0.12"/>
    </linearGradient>

    <!-- Noise level gradients -->
    <linearGradient id="lowNoiseGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#34D399"/>
      <stop offset="50%" stop-color="#10B981"/>
      <stop offset="100%" stop-color="#059669"/>
    </linearGradient>

    <linearGradient id="normalNoiseGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#FBBF24"/>
      <stop offset="50%" stop-color="#F59E0B"/>
      <stop offset="100%" stop-color="#D97706"/>
    </linearGradient>

    <linearGradient id="highNoiseGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#F87171"/>
      <stop offset="50%" stop-color="#EF4444"/>
      <stop offset="100%" stop-color="#DC2626"/>
    </linearGradient>

  </defs>

  <!-- Background -->
  <rect width="794" height="1123" fill="#FFFFFF"/>

  <!-- ========================================= -->
  <!-- HEADER SECTION -->
  <!-- ========================================= -->
  <g id="header">
    <rect width="794" height="140" fill="{{header_bg}}"/>
    <image href="{{logo_url}}" x="35" y="15" width="105" height="105" preserveAspectRatio="xMidYMid meet"/>
    <text x="160" y="65" fill="{{header_text_color}}" font-size="24" font-family="Inter, Arial, sans-serif" font-weight="700">
      {{header_title}}
    </text>
    <text x="160" y="95" fill="{{header_subtitle_color}}" font-size="16" font-family="Inter, Arial, sans-serif" font-weight="400">
      {{header_subtitle}}
    </text>
  </g>

  <!-- ========================================= -->
  <!-- REPORT INFO BAR -->
  <!-- ========================================= -->
  <g id="report-info">
    <rect x="30" y="160" width="734" height="48" class="card-elevated" rx="6" ry="6"/>

    <!-- Building Name -->
    <g transform="translate(50, 160)">
      <text y="18" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#6B7280" letter-spacing="0.5">NOMBRE DEL EDIFICIO</text>
      <text y="36" font-family="Inter, sans-serif" font-size="13" font-weight="600" fill="#111827">{{building_name}}</text>
    </g>

    <!-- Date Range -->
    <g transform="translate(280, 160)">
      <text y="18" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#6B7280" letter-spacing="0.5">PERIODO DEL INFORME</text>
      <text y="36" font-family="Inter, sans-serif" font-size="13" font-weight="600" fill="#111827">{{date_range}}</text>
    </g>

    <!-- Total Sensors -->
    <g transform="translate(500, 160)">
      <text y="18" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#6B7280" letter-spacing="0.5">TOTAL SENSORES</text>
      <text y="38" font-family="Inter, sans-serif" font-size="18" font-weight="700" fill="#111827">{{total_sensors}}</text>
    </g>

    <!-- Active Sensors -->
    <g transform="translate(640, 160)">
      <text y="18" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#6B7280" letter-spacing="0.5">ACTIVOS</text>
      <text y="38" font-family="Inter, sans-serif" font-size="18" font-weight="700" fill="{{accent_primary}}">{{active_sensors}}</text>
    </g>
  </g>

  <!-- ========================================= -->
  <!-- ACOUSTIC COMFORT INDICATOR -->
  <!-- ========================================= -->
  <g id="acoustic-comfort-indicator">
    <rect x="30" y="220" width="734" height="120" class="card-elevated" rx="8" ry="8"/>

    <!-- Title -->
    <g transform="translate(50, 248)">
      <text font-family="Inter, sans-serif" font-size="14" font-weight="700" fill="#1F2937">
        <tspan fill="#EF4444">游댉</tspan>
        <tspan dx="6">칈ndice de Confort Ac칰stico</tspan>
      </text>
    </g>

    <!-- Sound Wave Visualization -->
    <g id="sound-waves" transform="translate(50, 245)">
      <!-- Sound waves with gradient -->
      <path d="M 0,20 Q 30,0 60,20 T 120,20 T 180,20 T 240,20"
            stroke="{{acoustic_wave_color}}"
            stroke-width="8"
            fill="none"
            stroke-linecap="round"
            opacity="0.8"/>

      <!-- Amplitude indicator for current level -->
      <path d="M 260,20 Q 280,{{acoustic_wave_amplitude}} 300,20"
            stroke="{{acoustic_wave_color}}"
            stroke-width="12"
            fill="none"
            stroke-linecap="round"/>

      <!-- dB Scale markers with badges -->
      <g transform="translate(350, 0)">
        <rect x="-4" y="-11" width="135" height="18" rx="9" fill="#FEF2F2" stroke="#FECACA" stroke-width="0.5"/>
        <text x="0" y="3" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#DC2626">60 dB (Cr칤tico)</text>
      </g>
      <g transform="translate(350, 22)">
        <rect x="-4" y="-11" width="145" height="18" rx="9" fill="#ECFDF5" stroke="#A7F3D0" stroke-width="0.5"/>
        <text x="0" y="3" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#065F46">35-45 dB (Confort)</text>
      </g>
      <g transform="translate(350, 44)">
        <rect x="-4" y="-11" width="160" height="18" rx="9" fill="#F1F5F9" stroke="#CBD5E1" stroke-width="0.5"/>
        <text x="0" y="3" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#475569">Actual: {{avg_sound}} dB</text>
      </g>
    </g>

    <!-- Status with Traffic Light Circle -->
    <g id="acoustic-status" transform="translate(50, 315)">
      <!-- Traffic Light Circle with glow -->
      <circle cx="15" cy="0" r="12" fill="{{acoustic_status_color}}">
        <animate attributeName="opacity" values="1;0.7;1" dur="2s" repeatCount="indefinite"/>
      </circle>

      <!-- Status Text -->
      <text x="35" y="5" font-family="Inter, sans-serif" font-size="14" font-weight="600" fill="{{metric_value_color}}">{{acoustic_status_text}}</text>

      <!-- Percentage in comfort zone with badge -->
      <g transform="translate(350, 0)">
        <rect x="-8" y="-14" width="310" height="24" rx="12" fill="rgba(16, 185, 129, 0.1)" stroke="#10B981" stroke-width="1"/>
        <text x="0" y="4" font-family="Inter, sans-serif" font-size="12" font-weight="600" fill="#10B981">{{acoustic_comfort_percentage}}% tiempo en zona de confort (35-45 dB)</text>
      </g>
    </g>
  </g>

  <!-- ========================================= -->
  <!-- NOISE ANALYSIS CHART SECTION -->
  <!-- ========================================= -->
  <g id="chart-section">
    <text x="30" y="370" class="section-header">An치lisis de Contaminaci칩n Ac칰stica - Ubicaciones m치s Ruidosas</text>

    <rect x="30" y="380" width="734" height="280" class="card-elevated" rx="8"/>

    <!-- LEFT COLUMN: Sound Image -->
    <g id="sound-section" transform="translate(50, 395)">
      <image href="{{sound_url}}" x="30" y="10" width="120" height="240" preserveAspectRatio="xMidYMid meet"/>

      <!-- Max Sound Level -->
      <g transform="translate(160, 45)">
        <rect x="-8" y="-18" width="75" height="45" rx="6" fill="#FEF2F2" stroke="#FECACA" stroke-width="0.5"/>
        <text x="0" y="0" font-family="Inter, sans-serif" font-size="9" font-weight="700" fill="#DC2626" letter-spacing="0.5">MAX</text>
        <text x="0" y="18" font-family="Inter, sans-serif" font-size="18" font-weight="700" fill="#DC2626">{{overall_max_sound}}<tspan font-size="11"> dB</tspan></text>
      </g>

      <!-- Average Sound Level -->
      <g transform="translate(160, 115)">
        <rect x="-8" y="-18" width="75" height="45" rx="6" fill="#FFFBEB" stroke="#FDE68A" stroke-width="0.5"/>
        <text x="0" y="0" font-family="Inter, sans-serif" font-size="9" font-weight="700" fill="#D97706" letter-spacing="0.5">AVG</text>
        <text x="0" y="18" font-family="Inter, sans-serif" font-size="16" font-weight="700" fill="#D97706">{{overall_avg_sound}}<tspan font-size="10"> dB</tspan></text>
      </g>

      <!-- Min Sound Level -->
      <g transform="translate(160, 185)">
        <rect x="-8" y="-18" width="75" height="45" rx="6" fill="#ECFDF5" stroke="#A7F3D0" stroke-width="0.5"/>
        <text x="0" y="0" font-family="Inter, sans-serif" font-size="9" font-weight="700" fill="#10B981" letter-spacing="0.5">MIN</text>
        <text x="0" y="18" font-family="Inter, sans-serif" font-size="18" font-weight="700" fill="#10B981">{{overall_min_sound}}<tspan font-size="11"> dB</tspan></text>
      </g>
    </g>

    <!-- RIGHT COLUMN: Chart -->
    <g transform="translate(334, 395)">
      <!-- Chart Legend -->
      <g font-family="Inter, sans-serif">
        <g transform="translate(0, 0)">
          <rect width="8" height="8" rx="2" fill="#EF4444"/>
          <text x="14" y="8" font-size="9" font-weight="600" fill="#6B7280">M치s ruidoso</text>
        </g>
        <g transform="translate(110, 0)">
          <rect width="8" height="8" rx="2" fill="#10B981"/>
          <text x="14" y="8" font-size="9" font-weight="600" fill="#6B7280">M치s silencioso</text>
        </g>
        <g transform="translate(230, 0)">
          <line x1="0" y1="4" x2="12" y2="4" stroke="#9CA3AF" stroke-width="2" stroke-dasharray="4,2"/>
          <text x="18" y="8" font-size="9" font-weight="600" fill="#6B7280">Promedio</text>
        </g>
      </g>

      <!-- Chart Placeholder -->
      <foreignObject x="0" y="20" width="420" height="235">
        <div xmlns="http://www.w3.org/1999/xhtml" id="chart-container" style="width:100%; height:100%;">
          <canvas id="noise-comparison-chart"></canvas>
        </div>
      </foreignObject>
    </g>
  </g>

  <!-- ========================================= -->
  <!-- NOISE STATISTICS SECTION -->
  <!-- ========================================= -->
  <g id="noise-statistics">
    <text x="30" y="690" class="section-header">Estad칤sticas de Ruido</text>

    <!-- Noise Summary Card -->
    <rect x="30" y="700" width="734" height="120" class="card-elevated" rx="8"/>

    <g transform="translate(45, 720)">
      <text font-family="Inter, sans-serif" font-size="11" font-weight="700" fill="#6B7280" letter-spacing="0.5">
        <tspan fill="#F59E0B">游늵</tspan>
        <tspan dx="4">RESUMEN DE NIVELES SONOROS</tspan>
      </text>
    </g>

    <!-- 3 Column Layout with dividers -->
    <g id="noise-total-sensors" transform="translate(60, 745)">
      <text y="0" fill="#64748b" font-family="Inter, sans-serif" font-size="9" font-weight="600" letter-spacing="0.5">SENSORES TOTALES</text>
      <text y="25" fill="#111827" font-family="Inter, sans-serif" font-size="22" font-weight="700">{{total_sound_sensors}}</text>
      <text y="43" fill="#6B7280" font-family="Inter, sans-serif" font-size="10">Monitoreados</text>
    </g>

    <line x1="240" y1="745" x2="240" y2="793" stroke="#E5E7EB" stroke-width="1"/>

    <g id="noise-avg-level" transform="translate(280, 745)">
      <text y="0" fill="#64748b" font-family="Inter, sans-serif" font-size="9" font-weight="600" letter-spacing="0.5">NIVEL PROMEDIO</text>
      <text y="25" fill="#111827" font-family="Inter, sans-serif" font-size="22" font-weight="700">{{overall_avg_sound}}<tspan fill="#6B7280" font-size="12"> dB</tspan></text>
      <text y="43" fill="#6B7280" font-family="Inter, sans-serif" font-size="10">Nivel medio</text>
    </g>

    <line x1="490" y1="745" x2="490" y2="793" stroke="#E5E7EB" stroke-width="1"/>

    <g id="noise-threshold" transform="translate(530, 745)">
      <text y="0" fill="#64748b" font-family="Inter, sans-serif" font-size="9" font-weight="600" letter-spacing="0.5">POR ENCIMA DE UMBRAL</text>
      <text y="25" fill="#EF4444" font-family="Inter, sans-serif" font-size="22" font-weight="700">{{above_threshold_percent}}<tspan fill="#6B7280" font-size="12">%</tspan></text>
      <text y="43" fill="#6B7280" font-family="Inter, sans-serif" font-size="10">&gt; 70 dB del tiempo</text>
    </g>
  </g>

  <!-- ========================================= -->
  <!-- PEAK NOISE EVENTS SECTION -->
  <!-- ========================================= -->
  <g id="peak-noise-events">
    <text x="30" y="850" class="section-header">Eventos de Ruido Pico</text>

    <rect x="30" y="860" width="734" height="110" class="card-noise" rx="8"/>

    <g transform="translate(45, 880)">
      <text font-family="Inter, sans-serif" font-size="11" font-weight="700" fill="#FCA5A5">
        <tspan fill="#EF4444">游댉</tspan>
        <tspan dx="4">EVENTOS M츼S RUIDOSOS</tspan>
        <tspan dx="6" font-size="9" font-weight="500" fill="#94A3B8">(Top 2)</tspan>
      </text>
    </g>

    <!-- Table Header -->
    <g transform="translate(0, 905)" font-family="Inter, sans-serif" font-size="9" font-weight="600" fill="#64748B">
      <text x="45">Rank</text>
      <text x="100">Ubicaci칩n</text>
      <text x="250">Sensor</text>
      <text x="350">Nivel Pico</text>
      <text x="480">Tiempo</text>
      <text x="650">Duraci칩n</text>
    </g>

    <line x1="45" y1="913" x2="749" y2="913" stroke="#475569" stroke-width="0.5" opacity="0.5"/>

    <!-- Peak Row 1 -->
    <g transform="translate(0, 933)" font-family="Inter, sans-serif">
      <rect x="40" y="-12" width="24" height="18" rx="4" fill="#EF4444" opacity="0.2"/>
      <text x="52" fill="#FFFFFF" font-size="11" font-weight="700" text-anchor="middle">#1</text>
      <text x="100" fill="#E2E8F0" font-size="11">{{peak_noise_1_location}}</text>
      <text x="250" fill="#E2E8F0" font-size="11">{{peak_noise_1_sensor}}</text>
      <text x="350" fill="#FFFFFF" font-size="14" font-weight="700">{{peak_noise_1_value}}<tspan fill="#94A3B8" font-size="10"> dB</tspan></text>
      <text x="480" fill="#94A3B8" font-size="10">{{peak_noise_1_time}}</text>
      <text x="650" fill="#EF4444" font-size="10" font-weight="600">{{peak_noise_1_duration}}</text>
    </g>

    <!-- Peak Row 2 -->
    <g transform="translate(0, 955)" font-family="Inter, sans-serif">
      <rect x="40" y="-12" width="24" height="18" rx="4" fill="#EF4444" opacity="0.15"/>
      <text x="52" fill="#FECACA" font-size="11" font-weight="600" text-anchor="middle">#2</text>
      <text x="100" fill="#E2E8F0" font-size="11">{{peak_noise_2_location}}</text>
      <text x="250" fill="#E2E8F0" font-size="11">{{peak_noise_2_sensor}}</text>
      <text x="350" fill="#FFFFFF" font-size="14" font-weight="700">{{peak_noise_2_value}}<tspan fill="#94A3B8" font-size="10"> dB</tspan></text>
      <text x="480" fill="#94A3B8" font-size="10">{{peak_noise_2_time}}</text>
      <text x="650" fill="#EF4444" font-size="10" font-weight="600">{{peak_noise_2_duration}}</text>
    </g>
  </g>

  <!-- ========================================= -->
  <!-- FOOTER SECTION -->
  <!-- ========================================= -->
  <g id="footer">
    <line x1="30" y1="1050" x2="764" y2="1050" stroke="{{footer_bg}}" stroke-width="2"/>
    <rect y="1058" width="794" height="65" fill="{{footer_bg}}"/>
    <text x="40" y="1090" fill="{{footer_text_color}}" font-size="12" font-family="Inter, Arial, sans-serif">
      {{footer_text}}
    </text>
    <text x="754" y="1090" fill="{{footer_date_color}}" font-size="12" font-family="Inter, Arial, sans-serif" text-anchor="end">
      {{generation_date}}
    </text>
  </g>

</svg>
